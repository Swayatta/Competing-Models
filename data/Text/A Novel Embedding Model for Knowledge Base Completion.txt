New Orleans, Louisiana, June 1 - 6, 2018. c(cid:13)2018 Association for Computational Linguistics

Proceedings of NAACL-HLT 2018, pages 327–333

327

ANovelEmbeddingModelforKnowledgeBaseCompletionBasedonConvolutionalNeuralNetworkDaiQuocNguyen1,TuDinhNguyen1,DatQuocNguyen2,DinhPhung11DeakinUniversity,Geelong,Australia,CentreforPatternRecognitionandDataAnalytics{dai.nguyen,tu.nguyen,dinh.phung}@deakin.edu.au2TheUniversityofMelbourne,Australiadqnguyen@unimelb.edu.auAbstractInthispaper,weproposeanovelembeddingmodel,namedConvKB,forknowledgebasecompletion.OurmodelConvKBadvancesstate-of-the-artmodelsbyemployingaconvo-lutionalneuralnetwork,sothatitcancaptureglobalrelationshipsandtransitionalcharacter-isticsbetweenentitiesandrelationsinknowl-edgebases.InConvKB,eachtriple(headen-tity,relation,tailentity)isrepresentedasa3-columnmatrixwhereeachcolumnvectorrep-resentsatripleelement.This3-columnmatrixisthenfedtoaconvolutionlayerwheremulti-pleﬁltersareoperatedonthematrixtogener-atedifferentfeaturemaps.Thesefeaturemapsarethenconcatenatedintoasinglefeaturevec-torrepresentingtheinputtriple.Thefeaturevectorismultipliedwithaweightvectorviaadotproducttoreturnascore.Thisscoreisthenusedtopredictwhetherthetripleisvalidornot.ExperimentsshowthatConvKBachievesbetterlinkpredictionperformancethanpreviousstate-of-the-artembeddingmod-elsontwobenchmarkdatasetsWN18RRandFB15k-237.1IntroductionLarge-scaleknowledgebases(KBs),suchasYAGO(Suchaneketal.,2007),Freebase(Bol-lackeretal.,2008)andDBpedia(Lehmannetal.,2015),areusuallydatabasesoftriplesrepresent-ingtherelationshipsbetweenentitiesintheformoffact(headentity,relation,tailentity)denotedas(h,r,t),e.g.,(Melbourne,cityOf,Australia).TheseKBsareusefulresourcesinmanyapplicationssuchassemanticsearchingandranking(Kasnecietal.,2008;SchuhmacherandPonzetto,2014;Xiongetal.,2017),questionanswering(Zhangetal.,2016;Haoetal.,2017)andmachinereading(YangandMitchell,2017).However,theKBsarestillincomplete,i.e.,missingalotofvalidtriples(Socheretal.,2013;Westetal.,2014).There-fore,muchresearchworkhasbeendevotedto-wardsknowledgebasecompletionorlinkpredic-tiontopredictwhetheratriple(h,r,t)isvalidornot(Bordesetal.,2011).Manyembeddingmodelshaveproposedtolearnvectorormatrixrepresentationsforentitiesandrelations,obtainingstate-of-the-art(SOTA)linkpredictionresults(Nickeletal.,2016a).Intheseembeddingmodels,validtriplesobtainlowerimplausibilityscoresthaninvalidtriples.Letustakethewell-knownembeddingmodelTransE(Bordesetal.,2013)asanexample.InTransE,entitiesandrelationsarerepresentedbyk-dimensionalvectorembeddings.TransEemploysatransitionalcharacteristictomodelrelationshipsbetweenentities,inwhichitassumesthatif(h,r,t)isavalidfact,theembeddingofheadentityhplustheembeddingofrelationrshouldbeclosetotheembeddingoftailentityt,i.e.vh+vr≈vt(here,vh,vrandvtareembeddingsofh,randtrespec-tively).Thatis,aTransEscorekvh+vr−vtkpofthevalidtriple(h,r,t)shouldbecloseto0andsmallerthanascorekvh0+vr0−vt0kpofanin-validtriple(h’,r’,t’).Thetransitionalcharacteris-ticinTransEalsoimpliestheglobalrelationshipsamongsamedimensionalentriesofvh,vrandvt.Othertransition-basedmodelsextendTransEtoadditionallyuseprojectionvectorsormatricestotranslateheadandtailembeddingsintotherela-tionvectorspace,suchas:TransH(Wangetal.,2014),TransR(Linetal.,2015b),TransD(Jietal.,2015),STransE(Nguyenetal.,2016b)andTranSparse(Jietal.,2016).Furthermore,DIST-MULT(Yangetal.,2015)andComplEx(Trouil-lonetal.,2016)useatri-lineardotproducttocom-putethescoreforeachtriple.Recentresearch328

hasshownthatusingrelationpathsbetweenen-titiesintheKBscouldhelptogetcontextualin-formationforimprovingKBcompletionperfor-mance(Linetal.,2015a;Luoetal.,2015;Guuetal.,2015;Toutanovaetal.,2016;Nguyenetal.,2016a).SeeotherembeddingmodelsforKBcom-pletioninNguyen(2017).Recently,convolutionalneuralnetworks(CNNs),originallydesignedforcomputervision(LeCunetal.,1998),havesigniﬁcantlyreceivedresearchattentioninnaturallanguageprocessing(Collobertetal.,2011;Kim,2014).CNNlearnsnon-linearfeaturestocapturecomplexrelation-shipswitharemarkablylessnumberofparameterscomparedtofullyconnectedneuralnetworks.Inspiredfromthesuccessincomputervision,Dettmersetal.(2018)proposedConvE—theﬁrstmodelapplyingCNNfortheKBcompletiontask.InConvE,onlyvhandvrarereshapedandthenconcatenatedintoaninputmatrixwhichisfedtotheconvolutionlayer.Differentﬁltersofthesame3×3shapeareoperatedovertheinputmatrixtooutputfeaturemaptensors.Thesefeaturemaptensorsarethenvectorizedandmappedintoavectorviaalineartransformation.Thenthisvectoriscomputedwithvtviaadotproducttoreturnascorefor(h,r,t).SeeaformaldeﬁnitionoftheConvEscorefunctioninTable1.ItisworthnotingthatConvEfocusesonthelocalrelationshipsamongdifferentdimensionalentriesineachofvhorvr,i.e.,ConvEdoesnotobservetheglobalrelationshipsamongsamedimensionalentriesofanembeddingtriple(vh,vr,vt),sothatConvEignoresthetransitionalcharacteristicintransition-basedmodels,whichisoneofthemostusefulintuitionsforthetask.Inthispaper,wepresentConvKB—anembed-dingmodelwhichproposesanoveluseofCNNfortheKBcompletiontask.InConvKB,eachentityorrelationisassociatedwithanuniquek-dimensionalembedding.Letvh,vrandvtdenotek-dimensionalembeddingsofh,randt,respec-tively.Foreachtriple(h,r,t),thecorrespondingtripleofk-dimensionalembeddings(vh,vr,vt)isrepresentedasak×3inputmatrix.Thisin-putmatrixisfedtotheconvolutionlayerwheredifferentﬁltersofthesame1×3shapeareusedtoextracttheglobalrelationshipsamongsamedi-mensionalentriesoftheembeddingtriple.Thatis,theseﬁltersarerepeatedlyoperatedoverev-eryrowoftheinputmatrixtoproducedifferentModelThescorefunctionf(h,r,t)TransEkvh+vr-vtkpDISTMULThvh,vr,vtiComplExRe(hvh,vr,vti)ConvEg(vec(g(concat(bvh,bvr)∗Ω))W)·vtConvKBconcat(g([vh,vr,vt]∗Ω))·wTable1:ThescorefunctionsinpreviousSOTAmodelsandinourConvKBmodel.kvkpdenotesthep-normofv.hvh,vr,vti=Pivhivrivtidenotesatri-lineardotproduct.gdenotesanon-linearfunction.∗denotesaconvolutionoperator.·denotesadotproduct.concatdenotesaconcatenationoperator.bvdenotesa2Dre-shapingofv.Ωdenotesasetofﬁlters.featuremaps.Thefeaturemapsareconcatenatedintoasinglefeaturevectorwhichisthencomputedwithaweightvectorviaadotproducttoproduceascoreforthetriple(h,r,t).Thisscoreisusedtoinferwhetherthetriple(h,r,t)isvalidornot.Ourcontributionsinthispaperareasfollows:•WeintroduceConvKB—anovelembeddingmodelofentitiesandrelationshipsforknowl-edgebasecompletion.ConvKBmodelstherelationshipsamongsamedimensionalen-triesoftheembeddings.ThisimpliesthatConvKBgeneralizestransitionalcharacteris-ticsintransition-basedembeddingmodels.•WeevaluateConvKBontwobenchmarkdatasets:WN18RR(Dettmersetal.,2018)andFB15k-237(ToutanovaandChen,2015).ExperimentalresultsshowthatConvKBob-tainsbetterlinkpredictionperformancethanpreviousSOTAembeddingmodels.Inpartic-ular,ConvKBobtainsthebestmeanrankandthehighestHits@10onWN18RR,andpro-ducesthehighestmeanreciprocalrankandhighestHits@10onFB15k-237.2ProposedConvKBmodelAknowledgebaseGisacollectionofvalidfac-tualtriplesintheformof(headentity,relation,tailentity)denotedas(h,r,t)suchthath,t∈Eandr∈RwhereEisasetofentitiesandRisasetofrelations.Embeddingmodelsaimtodeﬁneascorefunctionfgivinganimplausibilityscoreforeachtriple(h,r,t)suchthatvalidtriplesreceivelowerscoresthaninvalidtriples.Table1presentsscorefunctionsinpreviousSOTAmodels.Wedenotethedimensionalityofembeddingsbyksuchthateachembeddingtriple(vh,vr,vt)are329

h     r     tk = 4matrix 4×33 filters 1×3convolution3 feature maps are concatenatedscoreReLUdotproductFigure1:ProcessinvolvedinConvKB(withtheem-beddingsizek=4,thenumberofﬁltersτ=3andtheactivationfunctiong=ReLUforillustrationpurpose).viewedasamatrixA=[vh,vr,vt]∈Rk×3.AndAi,:∈R1×3denotesthei-throwofA.Supposethatweuseaﬁlterω∈R1×3operatedontheconvolutionlayer.ωisnotonlyaimedtoexam-inetheglobalrelationshipsbetweensamedimen-sionalentriesoftheembeddingtriple(vh,vr,vt),butalsotogeneralizethetransitionalcharacteris-ticsinthetransition-basedmodels.ωisrepeatedlyoperatedovereveryrowofAtoﬁnallygenerateafeaturemapv=[v1,v2,...,vk]∈Rkas:vi=g(ω·Ai,:+b)whereb∈RisabiastermandgissomeactivationfunctionsuchasReLU.OurConvKBusesdifferentﬁlters∈R1×3togeneratedifferentfeaturemaps.LetΩandτde-notethesetofﬁltersandthenumberofﬁlters,respectively,i.e.τ=|Ω|,resultinginτfeaturemaps.Theseτfeaturemapsareconcatenatedintoasinglevector∈Rτk×1whichisthencomputedwithaweightvectorw∈Rτk×1viaadotprod-ucttogiveascoreforthetriple(h,r,t).Figure1illustratesthecomputationprocessinConvKB.Formally,wedeﬁnetheConvKBscorefunctionfasfollows:f(h,r,t)=concat(g([vh,vr,vt]∗Ω))·wwhereΩandwaresharedparameters,indepen-Dataset|E||R|#Triplesintrain/valid/testWN18RR40,9431186,8353,0343,134FB15k-23714,541237272,11517,53520,466Table2:Statisticsoftheexperimentaldatasets.dentofh,randt;∗denotesaconvolutionopera-tor;andconcatdenotesaconcatenationoperator.Ifweonlyuseoneﬁlterω(i.e.usingτ=1)withaﬁxedbiastermb=0andtheactiva-tionfunctiong(x)=|x|org(x)=x2,andﬁxω=[1,1,−1]andw=1duringtraining,Con-vKBreducestotheplainTransEmodel(Bordesetal.,2013).SoourConvKBmodelcanbeviewedasanextensionofTransEtofurthermodelglobalrelationships.WeusetheAdamoptimizer(KingmaandBa,2014)totrainConvKBbyminimizingthelossfunctionL(Trouillonetal.,2016)withL2regu-larizationontheweightvectorwofthemodel:L=X(h,r,t)∈{G∪G0}log(cid:0)1+exp(cid:0)l(h,r,t)·f(h,r,t)(cid:1)(cid:1)+λ2kwk22inwhich,l(h,r,t)=(cid:26)1for(h,r,t)∈G−1for(h,r,t)∈G0hereG0isacollectionofinvalidtriplesgeneratedbycorruptingvalidtriplesinG.3Experiments3.1DatasetsWeevaluateConvKBontwobenchmarkdatasets:WN18RR(Dettmersetal.,2018)andFB15k-237(ToutanovaandChen,2015).WN18RRandFB15k-237arecorrespondinglysubsetsoftwocommondatasetsWN18andFB15k(Bordesetal.,2013).AsnotedbyToutanovaandChen(2015),WN18andFB15kareeasybecausetheycontainmanyreversiblerelations.Soknowingrelationsarereversibleallowsustoeasilypredictthema-jorityoftesttriples,e.g.state-of-the-artresultsonbothWN18andFB15kareobtainedbyus-ingasimplereversalruleasshowninDettmersetal.(2018).Therefore,WN18RRandFB15k-237arecreatedtonotsufferfromthisreversiblerelationprobleminWN18andFB15k,forwhichtheknowledgebasecompletiontaskismorereal-istic.Table2presentsthestatisticsofWN18RRandFB15k-237.330

MethodWN18RRFB15k-237MRMRRH@10MRMRRH@10IRN(Shenetal.,2017)–––211–46.4KBGAN(CaiandWang,2018)–0.21348.1–0.27845.8DISTMULT(Yangetal.,2015)[?]51100.43492540.24141.9ComplEx(Trouillonetal.,2016)[?]52610.44513390.24742.8ConvE(Dettmersetal.,2018)52770.46482460.31649.1TransE(Bordesetal.,2013)(ourresults)33840.22650.13470.29446.5OurConvKBmodel25540.24852.52570.39651.7KBLRN(Garc´ıa-Dur´anandNiepert,2017)–––2090.30949.3R-GCN+(Schlichtkrulletal.,2017)––––0.24941.7NeuralLP(Yangetal.,2017)––––0.24036.2Node+LinkFeat(ToutanovaandChen,2015)––––0.29346.2Table3:ExperimentalresultsonWN18RRandFB15k-237testsets.MRRandH@10denotethemeanreciprocalrankandHits@10(in%),respectively.[?]:ResultsaretakenfromDettmersetal.(2018)whereHits@10andMRRareroundedto2decimalplacesonWN18RR.Thelast4rowsreportresultsofmodelsthatexploitinformationaboutrelationpaths(KBLRN,R-GCN+andNeuralLP)ortextualmentionsderivedfromalargeexternalcorpus(Node+LinkFeat).Thebestscoreisinbold,whilethesecondbestscoreisinunderline.3.2EvaluationprotocolIntheKBcompletionorlinkpredictiontask(Bor-desetal.,2013),thepurposeistopredictamissingentitygivenarelationandanotherentity,i.e,infer-ringhgiven(r,t)orinferringtgiven(h,r).Theresultsarecalculatedbasedonrankingthescoresproducedbythescorefunctionfontesttriples.FollowingBordesetal.(2013),foreachvalidtesttriple(h,r,t),wereplaceeitherhortbyeachofotherentitiesinEtocreateasetofcor-ruptedtriples.Weusethe“Filtered”settingpro-tocol(Bordesetal.,2013),i.e.,nottakinganycorruptedtriplesthatappearintheKBintoac-counts.Werankthevalidtesttripleandcorruptedtriplesinascendingorderoftheirscores.Weem-ploythreecommonevaluationmetrics:meanrank(MR),meanreciprocalrank(MRR),andHits@10(i.e.,theproportionofthevalidtesttriplesrankingintop10predictions).LowerMR,higherMRRorhigherHits@10indicatebetterperformance.3.3TrainingprotocolWeusethecommonBernoullitrick(Wangetal.,2014;Linetal.,2015b)togeneratetheheadortailentitieswhensamplinginvalidtriples.WealsouseentityandrelationembeddingsproducedbyTransEtoinitializeentityandrelationembeddingsinConvKB.WeemployaTransEimplementationavailableat:https://github.com/datquocnguyen/STransE.WetrainTransEusingagridsearchofhyper-parameters:thedimensionalityofem-beddingsk∈{50,100},SGDlearningrate∈{1e−4,5e−4,1e−3,5e−3},l1-normorl2-norm,andmarginγ∈{1,3,5,7}.ThehighestHits@10scoresonthevalidationsetarewhenusingl1-norm,learningrateat5e−4,γ=5andk=50forWN18RR,andusingl1-norm,learningrateat5e−4,γ=1andk=100forFB15k-237.Tolearnourmodelparametersincludingen-tityandrelationembeddings,ﬁltersωandtheweightvectorw,weuseAdam(KingmaandBa,2014)andselectitsinitiallearningrate∈{5e−6,1e−5,5e−5,1e−4,5e−4}.WeuseReLUastheactivationfunctiong.Weﬁxthebatchsizeat256andsettheL2-regularizerλat0.001inourobjectivefunction.Theﬁltersωareini-tializedbyatruncatednormaldistributionorby[0.1,0.1,−0.1].Weselectthenumberofﬁltersτ∈{50,100,200,400,500}.WerunConvKBupto200epochsanduseoutputsfromthelastepochforevaluation.ThehighestHits@10scoresonthevalidationsetareobtainedwhenusingk=50,τ=500,thetruncatednormaldistribu-tionforﬁlterinitialization,andtheinitiallearningrateat1e−4onWN18RR;andk=100,τ=50,[0.1,0.1,−0.1]forﬁlterinitialization,andtheini-tiallearningrateat5e−6onFB15k-237.3.4MainexperimentalresultsTable3comparestheexperimentalresultsofourConvKBmodelwithpreviouspublishedresults,usingthesameexperimentalsetup.Table3showsthatConvKBobtainsthebestMRandhighestHits@10scoresonWN18RRandalsothehighest331

MRRandHits@10scoresonFB15k-237.ConvKBdoesbetterthanthecloselyrelatedmodelTransEonbothexperimentaldatasets,es-peciallyonFB15k-237whereConvKBgainssig-niﬁcantimprovementsof347−257=90inMR(whichisabout26%relativeimprovement)and0.396−0.294=0.102inMRR(whichis34+%relativeimprovement),andalsoob-tains51.7−46.5=5.2%absoluteimprove-mentinHits@10.PreviousworkshowsthatTransEobtainsverycompetitiveresults(Linetal.,2015a;Nickeletal.,2016b;Trouillonetal.,2016;Nguyenetal.,2016a).However,whencompar-ingtheCNN-basedembeddingmodelConvEwithothermodels,Dettmersetal.(2018)didnotexper-imentwithTransE.Wereconﬁrmpreviousﬁnd-ingsthatTransEinfactisastrongbaselinemodel,e.g.,TransEobtainsbetterMRandHits@10thanConvEonWN18RR.ConvKBobtainsbetterscoresthanConvEonbothdatasets(exceptMRRonWN18RRandMRonFB15k-237),thusshowingtheusefulnessoftakingtransitionalcharacteristicsintoaccounts.Inparticular,onFB15k-237,ConvKBachievesim-provementsof0.394−0.316=0.078inMRR(whichisabout25%relativeimprovement)and51.7−49.1=2.6%inHits@10,whilebothConvKBandConvEproducesimilarMRscores.ConvKBalsoobtains25%relativelyhigherMRRscorethantherelationpath-basedmodelKBLRNonFB15k-237.Inaddition,ConvKBgivesbet-terHits@10thanKBLRN,however,KBLRNgivesbetterMRthanConvKB.WeplantoextendCon-vKBwithrelationpathinformationtoobtainbet-terlinkpredictionperformanceinfuturework.4ConclusionInthispaper,weproposeanovelembeddingmodelConvKBfortheknowledgebasecomple-tiontask.ConvKBappliestheconvolutionalneu-ralnetworktoexploretheglobalrelationshipsamongsamedimensionalentriesoftheentityandrelationembeddings,sothatConvKBgeneralizesthetransitionalcharacteristicsinthetransition-basedembeddingmodels.ExperimentalresultsshowthatourmodelConvKBoutperformsotherstate-of-the-artmodelsontwobenchmarkdatasetsWN18RRandFB15k-237.Ourcodeisavailableat:https://github.com/daiquocnguyen/ConvKB.WealsoplantoextendConvKBforanewappli-cationwherewecouldformulatedataintheformoftriples.Forexample,inspiredfromtheworkbyVuetal.(2017)forsearchpersonalization,wecanalsoapplyConvKBtomodeluser-orientedre-lationshipsbetweensubmittedqueriesanddocu-mentsreturnedbysearchengines,i.e.modelingtriplerepresentations(query,user,document).AcknowledgmentsThisresearchwaspartiallysupportedbytheAus-tralianResearchCouncil(ARC)DiscoveryGrantProjectDP160103934.